---
layout: post
title: 예비세션. Python-docx(파이썬으로 word문서 만들기)
category: test
---
예비 세션 3 - prod. 최효진

python-docx(파이썬으로 word문서 만들기)

# Python-docx만들기



## 1. python docx를 만들기 위한 환경 만들기

* vs code에 가상환경을 만든다.
{% highlight html %}

$ python -m venv myvenv #가상환경 만들기
$ source 가상환경이름/Scripts/activate #가상환경 실행하기

{% endhighlight %}

* 모듈 다운받기
{% highlight html %}
$ pip install python-docx
{% endhighlight %}

## 2. 제목과 문단 만들기

#### 시작하기
{% highlight html %}
document = Document() #사용하기위한 변수선언, 클래스처럼 Document() document변수에 넣는다.
{% endhighlight %}

#### 제목만들기
{% highlight html %}
document.add_heading('제목명', 0)을 통해서 제목을 넣을 수 있다.
document.add_heading('python-docx만들기', 0)
{% endhighlight %}
(사진넣기)

#### 문단 만들기

* 본문은 add_paragraphs('')함수를 이용해 입력해 준다.
  
{% highlight html %}
p = document.add_paragraph('안녕하세요, 저에 대해서 ')
{% endhighlight %}

* 이후 같은 paragraphs에 입력을 원할경우 add_run() 함수를 사용한다.
{% highlight html %}
p.add_run('자기소개').bold = True
p.add_run('를 해보겠습니다. ')
p.add_run('by. hyojin').italic = True
{% endhighlight %}


#### bold와 itatlic체
{% highlight html %}
내용을 굵게(bold), 기울임(italic)하고 싶다면 
p.add_run('자기소개').bold = True
p.add_run('를 해보겠습니다. ')
p.add_run('by. hyojin').italic = True
{% endhighlight %}

#### 폰트
* 글자 크기

기본적으로 Word에서는 '제목 1'로 나타나는 최상위 제목을 추가합니다.
하위 섹션의 제목을 원하면 1과 9 사이의 정수로 원하는 수준을 지정하면 된다.
{% highlight html %}
document.add_heading('인적사항', level=1)
document.add_heading('이름과 나이', level=2)
{% endhighlight %}

* 인용문
{% highlight html %}
document.add_paragraph('Intense quote', style='Intense Quote')
{% endhighlight %}

#### 리스트

* 순서가 없는 리스트
{% highlight html %}
document.add_paragraph('이름: 최효진', style='List Bullet')
{% endhighlight %}

다음과 같이도 사용가능하다.
{% highlight html %}
lists = document.add_paragraph('나이: 22세')
lists.style = 'List Bullet'
{% endhighlight %}

* 순서가 있는 리스트
{% highlight html %}
document.add_paragraph('전공: Global Business & Technology학부', style='List Number')
document.add_paragraph('학년: 3학년', style='List Number')
{% endhighlight %}


#### 이미지추가

* 업로드 하고 싶은 이미지 파일을 docx_practice.py가 있는 폴더에 넣고, 다음과 같이 작성한다.
{% highlight html %}
document.add_picture('image-filename.png')
{% endhighlight %}

* 이미지 사이즈
이미지 사이즈는 단위 Inches와 Cm 등 여러 단위를 사용가능하다.
이미지 사이즈 지정을 위한 단위를 사용하기 위해, 
{% highlight html %}
from docx.shared import Cm, Inches
{% endhighlight %}
파일의 제일 처음에 import해준다.

원하는 사이즈를 width-넓이와, height-높이의 ()괄호안에 넣어준다.
{% highlight html %}
document.add_picture('mung.png', width=Inches(1.25))
document.add_picture('cat.jpg',width= Cm(7), height= Cm(4))
{% endhighlight %}


#### 표 작성하기

* 표 생성
{% highlight html %}
table = document.add_table(rows=1, cols=3)
table.style = document.styles['Table Grid']
{% endhighlight %}

테이블의 row(행)과 cols(열)수만큼 숫자를 지정해준다.
테이블의 스타일을 []안에 넣는데, Table Grid는 테이블 기본 스타일이다.

* 다른 스타일의 테이블
다른 스타일의 테이블을 생성하고 싶다면, []안에 디폴트로 생성되어 있는 테이블 중 원하는 테이블명을 넣으면 된다.
{% highlight html %}
table.style = document.styles['Colorful Grid Accent 1']
{% endhighlight %}

'Table Grid'가 테이블 기본 스타일이라면, 'Colorful Grid Accent 1'은
디폴트테이블의 명은 python-docx의 공식문서에 있다.


#### 새로운 페이지 만들기
{% highlight html %}
document.add_page_break()
{% endhighlight %}

#### 파일 저장
{% highlight html %}
document.save('demo.docx')
{% endhighlight %}


















